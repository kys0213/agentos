# AgentOS 방향성 리뷰 (의견 제안)

본 문서는 현재 레포 구조와 구현을 검토한 뒤, 강점/보완점/우선순위 제안과 함께 중단기 로드맵 아이디어를 제시합니다. 목표는 “모델 아그노스틱, 로컬 퍼스트, 중앙 집계와 역전파로 성장하는 오픈소스 Agent OS”의 실현 가능성을 높이는 것입니다.

## 잘하고 있는 점
- 모델 아그노스틱 추상화: `llm-bridge-spec` + loader 조합으로 LLM 교체 내성 확보. 에이전트/프리셋 재사용성이 높음.
- 모듈 경계와 응집도: `agent/memory/knowledge/orchestrator/chat/preset/mcp`로 도메인 분리가 명확. 스프링/리액트식 조립 가능 구조.
- 로컬 퍼스트 철학: GUI가 로컬 상호작용을 1급 시민으로 취급. 파일/인메모리 저장으로 진입장벽 낮음.
- 오케스트레이션 전략: 규칙 기반 + LLM 기반 전략/리랭크의 조합이 확장성 있는 설계.
- 테스트 기반: core 전반의 테스트가 풍부해 리팩터링/교체 비용을 줄일 토대 보유.

## 보완이 필요한 점 (핵심)
- 브리지 계약의 기능 모델: 단순 타입 정의를 넘어 “지원 기능/한계(토큰화/함수호출/스트리밍/비용/지연)”를 선언적으로 노출하는 Capability 메타데이터 필요. 라우팅/프리셋 선택에 직접 활용.
- 데이터 계층 추상화: 파일/메모리 외에도 경량 영속 저장(SQLite/Level/SQLite-WASM) 어댑터를 표준화해 규모 확장, 동시성 제어, 부분 동기화를 용이하게.
- 중앙 수집/동기화 설계: 수집 스키마(메시지/메타/사용량/에러), 익명화/옵트인 정책, 충돌해결(merkle/clock 기반)과 증분 동기 프로토콜 정의 필요.
- 프리셋/정책 버저닝: 재현성과 롤백을 위해 Preset/Policy/Model 버전 동기(semver + 사인된 manifest)와 마켓/레지스트리 설계.
- 평가/관측 가능성: 자동 평가(정확성/비용/지연/안정성) 파이프라인과 오케스트레이터/브리지 수준의 트레이싱, 메트릭, 이벤트 로깅.
- 보안/격리: MCP/플러그인 실행 격리(권한/샌드박스/요청 필터링), Secret 관리, 프롬프트 주입 방어 가이드 강화.

## 아키텍처 제안
- Capability-Driven Routing
  - LLM 브리지의 Capability(예: max_tokens, tools, stream, cost_profile)를 선언적 JSON으로 노출 → Orchestrator가 정책/비용/지연 기반 다목적 라우팅.
- Storage Abstraction
  - `Storage` 인터페이스(세션/기억/지식/사용량) + File/SQLite/HTTP 동기 어댑터. 트랜잭션/락/배치/TTL/인덱싱 표준화.
- Sync & Backprop
  - 이벤트 소싱(append-only) + CRDT/lamport clock 기반 충돌해결. 백엔드에선 수집→정규화→특징화→정책 갱신→배포 파이프라인 자동화.
- RACP(제어면) 스펙 초안
  - 명령(Execute/Cancel/Pause)·승인(ACL/서명)·상태(Heartbeat/Progress)·감사(Audit) 최소 스키마. 멱등키와 재시도 규칙 명시.
- Preset Registry
  - 서명/무결성 검증, 의존 브리지/도구 최소 버전, 호환성 매트릭스. 로컬 캐시 + 원격 레지스트리 양자 지원.

## 단기 로드맵 (1–2개월)
- 스펙/문서
  - LLM Capability JSON 스키마 확정 및 브리지 샘플 1–2개 반영.
  - 중앙 수집 스키마 초안(PII 정책, 익명화, 옵트인) + 동기 프로토콜 설계 문서화.
- 구현
  - core Storage 인터페이스 + File/SQLite 어댑터 제공.
  - Orchestrator에 Capability/비용/지연 기반 라우팅 옵션 추가.
  - GUI: 프리셋 선택→세션→기억 반영→재사용 End-to-End 사용자 흐름 완성.
- 품질
  - 평가 하니스(샘플 데이터셋) + 비용/지연/성공률 대시보드 초안.

## 중기 로드맵 (3–6개월)
- 백엔드 수집 서버 PoC(인증/멀티테넌시/액세스 로그) + 동기 모듈 SDK.
- RACP MVP: 리더 Agent/사람이 원격으로 워크플로 지휘(명령/상태/취소/감사).
- Preset Registry 베타: 서명/버전/호환성 검증 + GUI 배포/업데이트 UX.
- 보안 강화: MCP 권한 모델, Secret Vault 연동, 플러그인 샌드박스.

## 리스크와 우회로
- ESM/CJS/번들링 편차: 워크스페이스 전반 ESM 일관성 유지, Vitest/Vite 설정 통일, 절대 경로 임포트 금지(ESLint)로 재발 방지.
- 비용/속도 불확실성: Capability 라우팅 + 평가 하니스로 가시화. 사전/사후 캐시, 임베딩/검색 파이프라인 튜닝.
- 데이터/프라이버시: 옵트인·익명화 디폴트, 민감필드 마스킹, 온프레미스/에어갭 지원.

## 총평
현 방향은 “모델 아그노스틱 + 로컬 퍼스트 + 중앙 수집/역전파”의 균형이 좋아, 현업/커뮤니티 모두에 실용적입니다. 특히 모듈 경계가 뚜렷해 제품/연구 양쪽 확장이 용이합니다. 다음 단계는 “계약의 명확화(브리지 Capability/수집 스키마/RACP)”와 “데이터 계층/동기화 표준화”입니다. 이를 통해 플라이휠을 안전하게 닫고, B2B 운영 신뢰성을 확보할 수 있습니다.
